<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ñ—É—Ä–Ω–∞–ª –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2c3e50;
            --secondary: #34495e;
            --success: #27ae60;
            --danger: #e74c3c;
            --warning: #f39c12;
            --info: #3498db;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --border: #bdc3c7;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        body {
            background: #f8f9fa;
            min-height: 100vh;
            padding: 20px;
            color: var(--dark);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left h1 {
            font-size: 28px;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .header-left p {
            opacity: 0.9;
            font-size: 14px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.15);
            padding: 10px 20px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .user-role {
            background: var(--success);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .btn-logout {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .btn-logout:hover {
            background: rgba(255,255,255,0.3);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        /* Tabs */
        .tabs {
            display: flex;
            background: var(--light);
            border-bottom: 1px solid var(--border);
        }

        .tab {
            padding: 16px 30px;
            background: transparent;
            color: var(--gray);
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            border-bottom: 3px solid transparent;
            font-weight: 500;
        }

        .tab:hover {
            color: var(--primary);
            background: rgba(255,255,255,0.5);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: white;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        /* Calendar Section */
        .calendar-section {
            background: white;
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .current-date {
            font-size: 20px;
            font-weight: 600;
            color: var(--dark);
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: var(--border);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .calendar-day-header {
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
            color: var(--dark);
            font-size: 13px;
            background: var(--light);
        }

        .calendar-day {
            padding: 15px 10px;
            text-align: center;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            font-size: 14px;
            position: relative;
            min-height: 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .calendar-day:hover {
            background: #e3f2fd;
            transform: translateY(-1px);
        }

        .calendar-day.selected {
            background: var(--primary);
            color: white;
            font-weight: 600;
        }

        .calendar-day.today {
            background: #fff3cd;
            font-weight: 600;
            border: 2px solid var(--warning);
        }

        .calendar-day.weekend {
            background: #f8f9fa;
            color: var(--danger);
        }

        .calendar-day.has-data::after {
            content: '';
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            background: var(--success);
            border-radius: 50%;
        }

        .calendar-day.absent-data::after {
            background: var(--danger);
        }

        .calendar-day.future {
            background: #f8f9fa;
            color: var(--gray);
        }

        .calendar-day.disabled {
            background: #f5f5f5;
            color: #cccccc;
            cursor: not-allowed;
        }

        .calendar-day.disabled:hover {
            background: #f5f5f5;
            transform: none;
        }

        /* Filters */
        .filters {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 20px;
            margin-bottom: 25px;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            font-size: 14px;
        }

        .filter-select {
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            background: white;
            transition: border-color 0.3s ease;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Students Grid */
        .students-container {
            max-height: 600px;
            overflow-y: auto;
            border: 1px solid var(--border);
            border-radius: 10px;
        }

        .students-grid {
            display: grid;
            gap: 1px;
            background: var(--border);
        }

        .student-row {
            display: grid;
            grid-template-columns: 1fr auto;
            background: white;
            padding: 15px 20px;
            align-items: center;
            transition: background-color 0.2s ease;
        }

        .student-row:nth-child(even) {
            background: #f8f9fa;
        }

        .student-row:hover {
            background: #e3f2fd;
        }

        .student-info h3 {
            font-size: 15px;
            margin-bottom: 4px;
            font-weight: 600;
        }

        .student-info p {
            color: var(--gray);
            font-size: 13px;
        }

        .attendance-controls {
            display: flex;
            gap: 10px;
        }

        .attendance-btn {
            padding: 8px 16px;
            border: 2px solid var(--border);
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 13px;
            font-weight: 500;
        }

        .attendance-btn.active {
            font-weight: 600;
            transform: scale(1.05);
        }

        .attendance-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-present {
            border-color: var(--success);
            color: var(--success);
        }

        .btn-present.active {
            background: var(--success);
            color: white;
        }

        .btn-absent {
            border-color: var(--danger);
            color: var(--danger);
        }

        .btn-absent.active {
            background: var(--danger);
            color: white;
        }

        /* Weekly Report */
        .week-report {
            border: 1px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
        }

        .week-report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .current-week {
            font-size: 20px;
            font-weight: 600;
            color: var(--dark);
        }

        .week-nav {
            display: flex;
            gap: 10px;
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .report-table th {
            background: var(--light);
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
            color: var(--dark);
            border: 1px solid var(--border);
            font-size: 12px;
        }

        .report-table td {
            padding: 12px 8px;
            text-align: center;
            border: 1px solid var(--border);
            font-size: 12px;
        }

        .student-name {
            text-align: left;
            font-weight: 600;
            background: var(--light);
            padding: 12px 15px;
            min-width: 200px;
        }

        .present-cell {
            background: #d4edda;
            color: #155724;
            font-weight: 600;
        }

        .absent-cell {
            background: #f8d7da;
            color: #721c24;
            font-weight: 600;
        }

        .total-cell {
            background: var(--primary);
            color: white;
            font-weight: 600;
        }

        .hours-cell {
            background: #e9ecef;
            font-weight: 600;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            box-shadow: var(--shadow);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--danger);
        }

        .notification.warning {
            background: var(--warning);
        }

        .notification.info {
            background: var(--info);
        }

        /* Access Message */
        .access-message {
            background: #fff3cd;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #ffeaa7;
            font-size: 14px;
        }

        .access-message h4 {
            color: #856404;
            margin-bottom: 8px;
            font-size: 15px;
        }

        .access-message p {
            color: #856404;
            margin: 0;
        }

        /* Admin Controls */
        .admin-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        /* Auto Save Status */
        .auto-save-status {
            background: #d1ecf1;
            padding: 12px 15px;
            border-radius: 6px;
            margin-top: 20px;
            font-size: 13px;
            color: #0c5460;
            border: 1px solid #bee5eb;
            text-align: center;
        }

        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .filters {
                grid-template-columns: 1fr;
            }
            
            .calendar-day {
                padding: 10px 5px;
                min-height: 50px;
                font-size: 12px;
            }
            
            .student-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .attendance-controls {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-left">
                <h1>üìí –ñ—É—Ä–Ω–∞–ª –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏</h1>
                <p>–°–∏—Å—Ç–µ–º–∞ —É—á–µ—Ç–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</p>
            </div>
            <div class="user-info">
                <span id="userFullName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                <span class="user-role" id="userRole">–†–æ–ª—å</span>
                <button class="btn btn-logout" onclick="logout()">–í—ã–π—Ç–∏</button>
            </div>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('daily')">üìÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —É—á–µ—Ç</button>
            <button class="tab" onclick="switchTab('weekly')">üìä –ù–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç</button>
        </div>

        <!-- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —É—á–µ—Ç -->
        <div id="daily" class="tab-content active">
            <div class="calendar-section">
                <div class="calendar-header">
                    <div class="current-date" id="currentMonth"></div>
                    <div class="calendar-nav">
                        <button class="btn btn-primary" onclick="changeMonth(-1)">‚óÄ –ù–∞–∑–∞–¥</button>
                        <button class="btn btn-primary" onclick="changeMonth(1)">–í–ø–µ—Ä–µ–¥ ‚ñ∂</button>
                    </div>
                </div>
                <div class="calendar-grid" id="calendarGrid"></div>
            </div>

            <div class="filters">
                <div class="filter-group">
                    <label for="professionFilter">–ü—Ä–æ—Ñ–µ—Å—Å–∏—è –∏ –≥—Ä—É–ø–ø–∞:</label>
                    <select id="professionFilter" class="filter-select" onchange="loadStudents()">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏—é</option>
                        <option value="programming-1">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ - –ì—Ä—É–ø–ø–∞ 1</option>
                        <option value="programming-2">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ - –ì—Ä—É–ø–ø–∞ 2</option>
                        <option value="design-1">–î–∏–∑–∞–π–Ω - –ì—Ä—É–ø–ø–∞ 1</option>
                        <option value="marketing-1">–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ - –ì—Ä—É–ø–ø–∞ 1</option>
                        <option value="management-1">–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç - –ì—Ä—É–ø–ø–∞ 1</option>
                    </select>
                </div>
                <div id="editModeContainer">
                    <button class="btn btn-warning" onclick="toggleEditMode()" id="editModeBtn">
                        ‚úèÔ∏è –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–í–ö–õ)
                    </button>
                </div>
            </div>

            <div id="accessMessage" class="access-message" style="display: none;">
                <h4>‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø</h4>
                <p>–í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–º–µ—á–∞—Ç—å –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å. –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã.</p>
            </div>

            <div class="students-container">
                <div class="students-grid" id="studentsList"></div>
            </div>

            <div class="auto-save-status" id="autoSaveStatus">
                üíæ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
            </div>
        </div>

        <!-- –ù–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç -->
        <div id="weekly" class="tab-content">
            <div class="week-report-header">
                <div class="current-week" id="currentWeek"></div>
                <div class="week-nav">
                    <button class="btn btn-primary" onclick="changeWeek(-1)">‚óÄ –ü—Ä–æ—à–ª–∞—è –Ω–µ–¥–µ–ª—è</button>
                    <button class="btn btn-primary" onclick="changeWeek(1)">–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è ‚ñ∂</button>
                </div>
            </div>

            <div class="filters">
                <div class="filter-group">
                    <label for="weekProfessionFilter">–ü—Ä–æ—Ñ–µ—Å—Å–∏—è –∏ –≥—Ä—É–ø–ø–∞:</label>
                    <select id="weekProfessionFilter" class="filter-select" onchange="generateWeekReport()">
                        <option value="">–í—Å–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏</option>
                        <option value="programming-1">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ - –ì—Ä—É–ø–ø–∞ 1</option>
                        <option value="programming-2">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ - –ì—Ä—É–ø–ø–∞ 2</option>
                        <option value="design-1">–î–∏–∑–∞–π–Ω - –ì—Ä—É–ø–ø–∞ 1</option>
                        <option value="marketing-1">–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ - –ì—Ä—É–ø–ø–∞ 1</option>
                        <option value="management-1">–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç - –ì—Ä—É–ø–ø–∞ 1</option>
                    </select>
                </div>
            </div>
            <div class="week-report">
                <div id="weekReport"></div>
            </div>
        </div>
    </div>

    <div id="notification" class="notification"></div>

    <script>
        // –î–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è–º –∏ –≥—Ä—É–ø–ø–∞–º
        const studentsData = {
            'programming-1': [
                { id: 1, name: '–ê–±–¥—É–Ω–∞–∑–∞—Ä–æ–≤ –ú—É—Ä–æ–¥—á–æ–Ω –≠—Å–æ–Ω–∞–ª–∏–µ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 2, name: '–í–∞–ª–∏–µ–≤–∞ –ú—É—Ö–ª–∏—Å–∞ –ê–±–¥—É–Ω–∞–±–∏–µ–≤–Ω–∞', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 3, name: '–ö–∞–º–æ–ª–æ–≤ –ú–∞—à—Ä–∞–±—á–æ–Ω –£–º–∞—Ä—á–æ–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 4, name: '–ö–∞–Ω–¥–∞—Ö–æ—Ä–æ–≤ –§–∞—Ä—Ä—É—Ö –ö–∞–º–æ–ª–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 5, name: '–ö–æ—Å–∏–º –§–∏—Ä–ª–∞–≤–µ –ù–∞–∑–∏—Ä—á–æ–Ω–≥–æ–ª–∞', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 6, name: '–ú–∞–º–∞—Ç–∫—É–ª–æ–≤ –ü–∞—Ä–∏–ª –ì–∞–π—Ä–∞—Ç—á–æ–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 7, name: '–ú–∏—Ä–≥–æ–ª–∏–±–æ–≤ –°–∞–Ω–∏–∞—Ñ–µ–∫ –¢—É–ª–∫–∏–Ω—á–æ–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 8, name: '–ú–∏—Ä—á–∞–ª–∏–ª–æ–≤–∞ –®–∞—Ö–ª–æ –•–æ–º–∏–¥—á–æ–Ω–æ–≤–∞', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 9, name: '–ù–∞–∑–∏—Ä–∫—É–ª–æ–≤ –§—É—Ä–∫–∞—Ç –û–π–±–µ–∫—á–æ–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 10, name: '–ù—É—Ä–∞–ª–∏–µ–≤ –î–∞–ª–µ—Ä –®—É—Ö—Ä–∞—Ç–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 11, name: '–ù–æ—Ä–º–∞—Ç–æ–≤ –®–∞—Ö—Ä—ã–µ—Ä –ò–∫—Ä–æ–º–∂–æ–Ω –£–≥–ª–∏', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 12, name: '–û–ª–∏–º–æ–≤ –î–∞–º–ø—Ä—á–æ–Ω –ó–∞–º–∏—Ä—á–æ–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 13, name: '–†–∞—Ö–∏–º–æ–≤ –®–∞–º—Å–∏–¥–¥–∏–Ω –†–∞–≤—à–∞–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 14, name: '–†–∞—á–∞–±–æ–≤ –ò—Å–∫–∞–Ω–¥–∞—Ä –ò–ª–∫–æ–º–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 15, name: '–¢–∞–π—è—Ä–æ–≤ –§–∞—Ä–∞–ª—É–ª –†—É—Å—Ç–∞–º—á–æ–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 16, name: '–§–∞–π—è–Ω–µ–≤ –†—É–∑–∏–∫—É–ª –ë–∞—Ö–æ–¥–∏—Ä–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 17, name: '–•–∞–π–¥–∞—Ä–æ–≤ –§–µ—Ä—É–∑ –°–∞–Ω–¥—á–æ–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 18, name: '–•–∞—Å–∞–Ω–æ–≤ –ê–∑–∏—è–Ω—Å–∫ –¢–æ—Ö–∏—Ä—á–æ–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 19, name: '–•–∞–π–¥–∞—Ä–æ–≤ –ê–ª–∏—á–æ–Ω –®–æ–¥–¥–µ—Ä—á–æ–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 20, name: '–ß—É—Ä–∞–µ–≤ –§–∏—Ä–ª–∞–≤–µ –ö–∞—Ö—Ä–∞–º–æ–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 21, name: '–®–∞–º—Å–∏–µ–≤ –ù–∞–π—Ä—É–∑–∏–æ—Ö –ò–ª–∫–æ–º–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 22, name: '–®–æ–¥–∏—Ö–æ–¥–∞ –°–∞–Ω—Ç–∏–Ω–º—É—Ö–∞–º–º–∞–¥–∏ –°–∞–∏–¥', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 23, name: '–Æ—Å—É–ø–æ–≤ –ë–æ–±—É—Ä—á–æ–Ω –†—É–¥–æ–º—á–æ–Ω–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 24, name: '–û–ª–∏–º–æ–≤ –ú–∞—Ö–º—É–¥—á–æ–Ω', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 25, name: '–ó–∏—Ö—Ä—É–ª–ª–æ–≤ –ê–º—Ä–∏–¥–¥–∏–Ω', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' }
            ],
            'programming-2': [
                { id: 26, name: '–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω –°–µ—Ä–≥–µ–µ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 27, name: '–°–∏–¥–æ—Ä–æ–≤–∞ –ê–Ω–Ω–∞ –ú–∏—Ö–∞–π–ª–æ–≤–Ω–∞', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' },
                { id: 28, name: '–ö–æ–∑–ª–æ–≤ –î–º–∏—Ç—Ä–∏–π –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–∏—á', profession: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ' }
            ],
            'design-1': [
                { id: 29, name: '–ò–≤–∞–Ω–æ–≤–∞ –ú–∞—Ä–∏—è –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞', profession: '–î–∏–∑–∞–π–Ω' },
                { id: 30, name: '–°–º–∏—Ä–Ω–æ–≤ –ê–ª–µ–∫—Å–µ–π –ü–µ—Ç—Ä–æ–≤–∏—á', profession: '–î–∏–∑–∞–π–Ω' }
            ],
            'marketing-1': [
                { id: 31, name: '–ö—É–∑–Ω–µ—Ü–æ–≤–∞ –ï–ª–µ–Ω–∞ –í–∏–∫—Ç–æ—Ä–æ–≤–Ω–∞', profession: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥' },
                { id: 32, name: '–ü–æ–ø–æ–≤ –°–µ—Ä–≥–µ–π –ù–∏–∫–æ–ª–∞–µ–≤–∏—á', profession: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥' }
            ],
            'management-1': [
                { id: 33, name: '–í–∞—Å–∏–ª—å–µ–≤–∞ –û–ª—å–≥–∞ –î–º–∏—Ç—Ä–∏–µ–≤–Ω–∞', profession: '–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç' },
                { id: 34, name: '–§–µ–¥–æ—Ä–æ–≤ –ê–Ω–¥—Ä–µ–π –ò–≥–æ—Ä–µ–≤–∏—á', profession: '–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç' }
            ]
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentUser = null;
        let currentDate = new Date();
        let selectedDate = new Date();
        let currentWeekStart = new Date();
        let editMode = true;
        let attendanceData = {};
        let lockedDays = {};

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function checkAuth() {
            const userData = localStorage.getItem('currentUser');
            
            if (userData) {
                currentUser = JSON.parse(userData);
                showMainApp();
            } else {
                window.location.href = 'index.html';
            }
        }

        function showMainApp() {
            document.getElementById('userFullName').textContent = currentUser.name;
            document.getElementById('userRole').textContent = getRoleName(currentUser.role);
            
            setupAccessRights();
            initApp();
            showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${currentUser.name}!`, 'success');
        }

        function getRoleName(role) {
            const roles = {
                'dezhur': '–î–µ–∂—É—Ä–Ω—ã–π',
                'admin': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                'dekan': '–î–µ–∫–∞–Ω'
            };
            return roles[role] || role;
        }

        function setupAccessRights() {
            if (currentUser.role === 'dezhur') {
                document.getElementById('accessMessage').style.display = 'block';
                document.getElementById('editModeContainer').style.display = 'none';
            }
            
            // –î–ª—è –∞–¥–º–∏–Ω–∞ –∏ –¥–µ–∫–∞–Ω–∞ –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            if (currentUser.role === 'admin' || currentUser.role === 'dekan') {
                editMode = true;
                updateEditModeButton();
            }
        }

        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        function loadData() {
            const saved = localStorage.getItem('attendanceData');
            if (saved) {
                attendanceData = JSON.parse(saved);
            }
            
            const savedLockedDays = localStorage.getItem('lockedDays');
            if (savedLockedDays) {
                lockedDays = JSON.parse(savedLockedDays);
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        function saveData() {
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
            localStorage.setItem('lockedDays', JSON.stringify(lockedDays));
            
            if (currentUser.role === 'dezhur') {
                const todayKey = new Date().toISOString().split('T')[0];
                if (!lockedDays[todayKey]) {
                    lockedDays[todayKey] = {};
                }
                lockedDays[todayKey][currentUser.id] = true;
                localStorage.setItem('lockedDays', JSON.stringify(lockedDays));
                
                showNotification('–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã. –î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ.', 'warning');
            } else {
                showNotification('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
            }
        }

        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        function autoSave() {
            saveData();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initApp() {
            loadData();
            setCurrentWeekStart();
            generateCalendar();
            generateWeekReport();
            
            setInterval(autoSave, 30000);
        }

        // –ö–∞–ª–µ–Ω–¥–∞—Ä—å
        function generateCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            const currentMonth = document.getElementById('currentMonth');
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            currentMonth.textContent = currentDate.toLocaleString('ru', { 
                month: 'long', 
                year: 'numeric' 
            }).replace(/^./, c => c.toUpperCase());
            
            calendarGrid.innerHTML = '';
            
            // –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
            const days = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
            days.forEach(day => {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day-header';
                dayElement.textContent = day;
                calendarGrid.appendChild(dayElement);
            });
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            // –ü—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏ –¥–æ –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è
            let firstDayOfWeek = firstDay.getDay();
            if (firstDayOfWeek === 0) firstDayOfWeek = 6;
            else firstDayOfWeek--;
            
            for (let i = 0; i < firstDayOfWeek; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day disabled';
                calendarGrid.appendChild(emptyDay);
            }
            
            // –î–Ω–∏ –º–µ—Å—è—Ü–∞
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;
                
                const date = new Date(year, month, day);
                date.setHours(0, 0, 0, 0);
                const dateKey = date.toISOString().split('T')[0];
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å
                if (date.getTime() === today.getTime()) {
                    dayElement.classList.add('today');
                }
                
                // –í—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏
                if (date.getDay() === 0 || date.getDay() === 6) {
                    dayElement.classList.add('weekend');
                }
                
                // –ë—É–¥—É—â–∏–µ –¥–Ω–∏
                if (date > today) {
                    dayElement.classList.add('future');
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å
                if (hasAttendanceData(dateKey)) {
                    dayElement.classList.add(hasAbsences(dateKey) ? 'absent-data' : 'has-data');
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–Ω—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                if (canUserEditDate(date)) {
                    dayElement.onclick = () => selectDate(date);
                } else {
                    dayElement.classList.add('disabled');
                }
                
                // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–µ–Ω—å
                if (date.getTime() === selectedDate.getTime()) {
                    dayElement.classList.add('selected');
                }
                
                calendarGrid.appendChild(dayElement);
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞—Ç—É
        function canUserEditDate(date) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const dateKey = date.toISOString().split('T')[0];
            
            // –ê–¥–º–∏–Ω –∏ –¥–µ–∫–∞–Ω –∏–º–µ—é—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –¥–∞—Ç–∞–º
            if (currentUser.role === 'admin' || currentUser.role === 'dekan') {
                return true;
            }
            
            // –î–µ–∂—É—Ä–Ω—ã–π –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–µ–≥–æ–¥–Ω—è
            if (currentUser.role === 'dezhur') {
                if (date.getTime() !== today.getTime()) {
                    return false;
                }
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ —ç—Ç–æ—Ç –¥–µ–Ω—å –¥–ª—è –¥–µ–∂—É—Ä–Ω–æ–≥–æ
                return !lockedDays[dateKey] || !lockedDays[dateKey][currentUser.id];
            }
            
            return false;
        }

        function hasAttendanceData(dateKey) {
            return Object.keys(attendanceData).some(profGroup => 
                attendanceData[profGroup] && attendanceData[profGroup][dateKey]
            );
        }

        function hasAbsences(dateKey) {
            return Object.keys(attendanceData).some(profGroup => 
                attendanceData[profGroup] && 
                attendanceData[profGroup][dateKey] &&
                Object.values(attendanceData[profGroup][dateKey]).some(status => status === 'absent')
            );
        }

        function selectDate(date) {
            if (!canUserEditDate(date)) {
                if (currentUser.role === 'dezhur') {
                    showNotification('–î–µ–∂—É—Ä–Ω—ã–π –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–º –¥–Ω–µ–º!', 'error');
                } else {
                    showNotification('–≠—Ç–æ—Ç –¥–µ–Ω—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
                }
                return;
            }
            
            selectedDate = date;
            generateCalendar();
            loadStudents();
            
            const dateString = selectedDate.toLocaleDateString('ru', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            }).replace(/^./, c => c.toUpperCase());
            
            showNotification(`–í—ã–±—Ä–∞–Ω–∞ –¥–∞—Ç–∞: ${dateString}`, 'success');
        }

        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            generateCalendar();
            autoSelectDateAfterMonthChange();
        }

        function autoSelectDateAfterMonthChange() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const lastDay = new Date(year, month + 1, 0).getDate();
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            // –î–ª—è –∞–¥–º–∏–Ω–∞ –∏ –¥–µ–∫–∞–Ω–∞ –≤—ã–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞
            if (currentUser.role === 'admin' || currentUser.role === 'dekan') {
                const firstDate = new Date(year, month, 1);
                selectDate(firstDate);
                return;
            }
            
            // –î–ª—è –¥–µ–∂—É—Ä–Ω–æ–≥–æ –ø—ã—Ç–∞–µ–º—Å—è –≤—ã–±—Ä–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å
            const todayInThisMonth = new Date(today.getFullYear(), today.getMonth(), today.getDate());
            if (todayInThisMonth.getMonth() === month && todayInThisMonth.getFullYear() === year && canUserEditDate(todayInThisMonth)) {
                selectDate(todayInThisMonth);
                return;
            }
            
            // –ò—â–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞
            for (let day = lastDay; day >= 1; day--) {
                const date = new Date(year, month, day);
                if (canUserEditDate(date)) {
                    selectDate(date);
                    return;
                }
            }
        }

        // –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        function loadStudents() {
            const professionFilter = document.getElementById('professionFilter');
            const selectedProfession = professionFilter.value;
            
            if (!selectedProfession) {
                document.getElementById('studentsList').innerHTML = '<div class="student-row"><div class="student-info"><p>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏—é –∏ –≥—Ä—É–ø–ø—É</p></div></div>';
                return;
            }
            
            const students = studentsData[selectedProfession] || [];
            const studentsList = document.getElementById('studentsList');
            studentsList.innerHTML = '';
            
            const dateKey = selectedDate.toISOString().split('T')[0];
            const canEdit = canUserEditDate(selectedDate) && editMode;
            
            if (students.length === 0) {
                studentsList.innerHTML = '<div class="student-row"><div class="student-info"><p>–°—Ç—É–¥–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p></div></div>';
                return;
            }
            
            students.forEach(student => {
                const row = document.createElement('div');
                row.className = 'student-row';
                
                const currentStatus = attendanceData[selectedProfession] && 
                                   attendanceData[selectedProfession][dateKey] && 
                                   attendanceData[selectedProfession][dateKey][student.id];
                
                row.innerHTML = `
                    <div class="student-info">
                        <h3>${student.name}</h3>
                        <p>${student.profession} - –ì—Ä—É–ø–ø–∞ ${selectedProfession.split('-')[1]}</p>
                    </div>
                    <div class="attendance-controls">
                        <button class="attendance-btn btn-present ${currentStatus === 'present' ? 'active' : ''}" 
                                onclick="markAttendance(${student.id}, 'present')"
                                ${!canEdit ? 'disabled' : ''}>
                            –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª
                        </button>
                        <button class="attendance-btn btn-absent ${currentStatus === 'absent' ? 'active' : ''}" 
                                onclick="markAttendance(${student.id}, 'absent')"
                                ${!canEdit ? 'disabled' : ''}>
                            –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª
                        </button>
                    </div>
                `;
                
                studentsList.appendChild(row);
            });
        }

        function markAttendance(studentId, status) {
            const professionFilter = document.getElementById('professionFilter');
            const selectedProfession = professionFilter.value;
            
            if (!selectedProfession) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏—é –∏ –≥—Ä—É–ø–ø—É!', 'error');
                return;
            }
            
            if (!canUserEditDate(selectedDate)) {
                showNotification('–≠—Ç–æ—Ç –¥–µ–Ω—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
                return;
            }
            
            if (!editMode) {
                showNotification('–í–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!', 'error');
                return;
            }
            
            const dateKey = selectedDate.toISOString().split('T')[0];
            
            if (!attendanceData[selectedProfession]) {
                attendanceData[selectedProfession] = {};
            }
            
            if (!attendanceData[selectedProfession][dateKey]) {
                attendanceData[selectedProfession][dateKey] = {};
            }
            
            attendanceData[selectedProfession][dateKey][studentId] = status;
            loadStudents();
            generateCalendar();
            
            autoSave();
            
            showNotification(`–°—Ç–∞—Ç—É—Å —Å—Ç—É–¥–µ–Ω—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω: ${status === 'present' ? '–ü—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª' : '–û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª'}`, 'success');
        }

        function toggleEditMode() {
            if (currentUser.role === 'dezhur') {
                showNotification('–î–µ–∂—É—Ä–Ω—ã–π –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è', 'info');
                return;
            }
            
            editMode = !editMode;
            updateEditModeButton();
            loadStudents();
            
            if (editMode) {
                showNotification('–†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∫–ª—é—á–µ–Ω', 'success');
            } else {
                showNotification('–†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–∫–ª—é—á–µ–Ω', 'warning');
            }
        }

        function updateEditModeButton() {
            const btn = document.getElementById('editModeBtn');
            if (editMode) {
                btn.classList.add('btn-warning');
                btn.innerHTML = '‚úèÔ∏è –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–í–ö–õ)';
            } else {
                btn.classList.remove('btn-warning');
                btn.innerHTML = '‚úèÔ∏è –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–í–´–ö–õ)';
            }
        }

        // –ù–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
        function setCurrentWeekStart() {
            const today = new Date();
            const day = today.getDay();
            const diff = day === 0 ? -6 : 1 - day;
            currentWeekStart = new Date(today);
            currentWeekStart.setDate(today.getDate() + diff);
            currentWeekStart.setHours(0, 0, 0, 0);
        }

        function changeWeek(direction) {
            currentWeekStart.setDate(currentWeekStart.getDate() + (direction * 7));
            generateWeekReport();
        }

        function generateWeekReport() {
            const weekProfessionFilter = document.getElementById('weekProfessionFilter');
            const selectedProfession = weekProfessionFilter.value;
            const weekReport = document.getElementById('weekReport');
            const currentWeek = document.getElementById('currentWeek');
            
            // –ü–æ–ª—É—á–∞–µ–º –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏ (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ - —Å—É–±–±–æ—Ç–∞)
            const weekDays = [];
            for (let i = 0; i < 6; i++) {
                const date = new Date(currentWeekStart);
                date.setDate(currentWeekStart.getDate() + i);
                weekDays.push(date);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ–¥–µ–ª–∏
            const weekEnd = new Date(currentWeekStart);
            weekEnd.setDate(currentWeekStart.getDate() + 5);
            currentWeek.textContent = `–ù–µ–¥–µ–ª—è: ${currentWeekStart.toLocaleDateString('ru')} - ${weekEnd.toLocaleDateString('ru')}`;
            
            let tableHTML = `
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>–°—Ç—É–¥–µ–Ω—Ç</th>
                            <th>–ì—Ä—É–ø–ø–∞</th>
            `;
            
            weekDays.forEach(day => {
                tableHTML += `<th>${day.toLocaleDateString('ru', { weekday: 'short', day: 'numeric', month: 'short' })}</th>`;
            });
            
            tableHTML += `<th>–ò—Ç–æ–≥ –Ω–µ–¥–µ–ª–∏</th></tr></thead><tbody>`;
            
            const professions = selectedProfession ? [selectedProfession] : Object.keys(studentsData);
            
            professions.forEach(profGroup => {
                const students = studentsData[profGroup];
                const groupName = profGroup.split('-')[1];
                
                students.forEach(student => {
                    tableHTML += `<tr>
                        <td class="student-name">${student.name}</td>
                        <td class="hours-cell">${groupName}</td>`;
                    
                    let presentDays = 0;
                    let absentDays = 0;
                    
                    weekDays.forEach(day => {
                        const dateKey = day.toISOString().split('T')[0];
                        const status = attendanceData[profGroup] && 
                                     attendanceData[profGroup][dateKey] && 
                                     attendanceData[profGroup][dateKey][student.id];
                        
                        if (status === 'present') {
                            tableHTML += `<td class="present-cell">‚úì</td>`;
                            presentDays++;
                        } else if (status === 'absent') {
                            tableHTML += `<td class="absent-cell">‚úó</td>`;
                            absentDays++;
                        } else {
                            tableHTML += `<td>-</td>`;
                        }
                    });
                    
                    const totalHours = absentDays * 6;
                    tableHTML += `<td class="hours-cell">
                        <div>–ü—Ä–æ–ø—É—â–µ–Ω–æ: ${totalHours}—á</div>
                        <div>–ü—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª: ${presentDays}–¥</div>
                        <div>–û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª: ${absentDays}–¥</div>
                    </td></tr>`;
                });
            });
            
            tableHTML += `</tbody></table>`;
            weekReport.innerHTML = tableHTML;
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`.tab[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'weekly') {
                generateWeekReport();
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–¥–º–∏–Ω–∞ –∏ –¥–µ–∫–∞–Ω–∞
        function clearAttendanceData() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                attendanceData = {};
                lockedDays = {};
                localStorage.removeItem('attendanceData');
                localStorage.removeItem('lockedDays');
                
                generateCalendar();
                loadStudents();
                generateWeekReport();
                
                showNotification('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ –æ—á–∏—â–µ–Ω—ã', 'success');
            }
        }

        function exportData() {
            const dataStr = JSON.stringify(attendanceData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `attendance_data_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showNotification('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ JSON —Ñ–∞–π–ª', 'success');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = checkAuth;

        // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω–∞ –∏ –¥–µ–∫–∞–Ω–∞
        document.addEventListener('DOMContentLoaded', function() {
            if (currentUser && (currentUser.role === 'admin' || currentUser.role === 'dekan')) {
                const headerLeft = document.querySelector('.header-left');
                const adminControls = document.createElement('div');
                adminControls.className = 'admin-controls';
                adminControls.innerHTML = `
                    <button class="btn btn-primary" onclick="exportData()">üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                    <button class="btn btn-danger" onclick="clearAttendanceData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                `;
                headerLeft.appendChild(adminControls);
            }
        });
    </script>
</body>
</html>